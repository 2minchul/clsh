# CLSH(Cluster Shell)

## 1. 기본 기능
- SSH 프로세스 실행
    - 각 호스트에 대해 exec.Command를 통해 SSH 프로세스를 실행하고 stdin, stdout, stderr 파이프를 설정합니다.
- 다수의 원격 쉘에 동일한 명령어 실행
    - 명령어 예시: `clsh -h node1,node2,node3,node4 cat /proc/loadavg`
    - 실행 결과 예시
        ```
        node1: 0.02 0.01 0.00 1/202 23042
        node4: 0.02 0.01 0.00 1/202 23042  
        node2: 0.02 0.01 0.00 1/202 23042 
        node3: 0.02 0.01 0.00 1/202 23042
        ```
- 호스트 목록 지정 방법
    - \--hostfile 옵션
        - 한 라인에 하나의 호스트명 또는 IP 주소
        - 예)
            ```
            node1
            node2
            node3 
            ```
    - \--hostfile 옵션 생략 시
        - CLSH_HOSTS 환경변수 사용
        - CLSH_HOSTFILE 환경변수 사용
        - 기본 호스트파일(.hostfile) 사용
        - 모두 실패 시 에러 출력
            - 에러 메시지: "--hostfile 옵션이 제공되지 않았습니다"

## 2. 추가 기능

### 1) 리디렉션
- 쉘 리디렉션 지원
    - `-b` 옵션이 있을때 다른 쉘 명령의 출력을 clsh 입력으로 사용
        - 예) `ls /etc/*.conf | clsh -hostfile hosts.txt -b xargs ls`
- 표준 출력, 표준 에러의 파일 리디렉션
    - 출력 파일: `--out=/tmp/run/`
    - 에러 파일: `--err=/tmp/run/error`

### 2) 인터랙티브 모드
- `-i` 옵션을 통한 인터랙티브 쉘 지원
    - 사용자 입력에 따른 원격 명령 실행
    - 키보드 입력 시 1:1 매핑
- 내부 쉘 지원
    - 별도의 명령 없이 사용자 입력 대기
    - 입력된 명령을 모든 호스트에 전달
    - !명령어: 로컬 쉘에서 해당 명령 실행
        - 출력 형태
            - LOCAL: 실행결과

### 3) 신호 처리
- 메인 프로세스의 시그널에 따른 SSH 연결 제어
    - 종료 시그널: 정상 종료
    - SIGTERM 시그널: 처리 완료 후 정상 종료
    - SIGQUIT 시그널: 즉시 중지
- 원격 실행 중인 프로세스 함께 종료

### 4) 예외 처리
- SSH 연결 끊김 감지 시 에러 출력
    - 에러 메시지: "ERROR: <호스트이름> connection lost"
    - 에러 출력 후 나머지 모든 연결 종료

## 3. 기타

- SSH 연결
    - 패스워드 입력 요청 시 CLSH에서 나타날 수 있도록 처리

- 컴파일/설치 가이드 문서 제공
- 사용 가이드 문서 제공